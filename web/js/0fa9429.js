/*!
 * Cropper v2.2.5
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2016 Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: 2016-01-18T05:42:50.800Z
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}})(function(ak){var K=ak(window);var x=ak(document);var aq=window.location;var am=window.ArrayBuffer;var E=window.Uint8Array;var l=window.DataView;var I=window.btoa;var f="cropper";var v="cropper-modal";var ah="cropper-hide";var V="cropper-hidden";var ab="cropper-invisible";var ai="cropper-move";var T="cropper-crop";var O="cropper-disabled";var C="cropper-bg";var y="mousedown touchstart pointerdown MSPointerDown";var af="mousemove touchmove pointermove MSPointerMove";var Z="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel";var b="wheel mousewheel DOMMouseScroll";var q="dblclick";var an="load."+f;var X="error."+f;var Q="resize."+f;var d="build."+f;var a="built."+f;var j="cropstart."+f;var ay="cropmove."+f;var aj="cropend."+f;var n="crop."+f;var av="zoom."+f;var aw=/e|w|s|n|se|sw|ne|nw|all|crop|move|zoom/;var h=/^data\:/;var N=/^data\:([^\;]+)\;base64,/;var S=/^data\:image\/jpeg.*;base64,/;var aA="preview";var g="action";var W="e";var ap="w";var e="s";var i="n";var A="se";var ac="sw";var w="ne";var Y="nw";var o="all";var aa="crop";var au="move";var H="zoom";var t="none";var p=ak.isFunction(ak("<canvas>")[0].getContext);var az=Number;var at=Math.min;var k=Math.max;var L=Math.abs;var ag=Math.sin;var r=Math.cos;var B=Math.sqrt;var D=Math.round;var R=Math.floor;var c=String.fromCharCode;function J(aC){return typeof aC==="number"&&!isNaN(aC)}function M(aC){return typeof aC==="undefined"}function G(aD,aE){var aC=[];if(J(aE)){aC.push(aE)}return aC.slice.apply(aD,aC)}function s(aE,aD){var aC=G(arguments,2);return function(){return aE.apply(aD,aC.concat(G(arguments)))}}function U(aC){var aD=aC.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return aD&&(aD[1]!==aq.protocol||aD[2]!==aq.hostname||aD[3]!==aq.port)}function z(aC){var aD="timestamp="+(new Date()).getTime();return(aC+(aC.indexOf("?")===-1?"?":"&")+aD)}function aB(aC){return aC?' crossOrigin="'+aC+'"':""}function m(aC,aE){var aD;if(aC.naturalWidth){return aE(aC.naturalWidth,aC.naturalHeight)}aD=document.createElement("img");aD.onload=function(){aE(this.width,this.height)};aD.src=aC.src}function ad(aF){var aG=[];var aE=aF.rotate;var aD=aF.scaleX;var aC=aF.scaleY;if(J(aE)){aG.push("rotate("+aE+"deg)")}if(J(aD)&&J(aC)){aG.push("scale("+aD+","+aC+")")}return aG.length?aG.join(" "):"none"}function ax(aI,aG){var aD=L(aI.degree)%180;var aF=(aD>90?(180-aD):aD)*Math.PI/180;var aJ=ag(aF);var aL=r(aF);var aE=aI.width;var aM=aI.height;var aK=aI.aspectRatio;var aH;var aC;if(!aG){aH=aE*aL+aM*aJ;aC=aE*aJ+aM*aL}else{aH=aE/(aL+aJ/aK);aC=aH/aK}return{width:aH,height:aC}}function al(aL,aT){var aE=ak("<canvas>")[0];var aD=aE.getContext("2d");var aJ=0;var aI=0;var aM=aT.naturalWidth;var aK=aT.naturalHeight;var aN=aT.rotate;var aQ=aT.scaleX;var aP=aT.scaleY;var aH=J(aQ)&&J(aP)&&(aQ!==1||aP!==1);var aR=J(aN)&&aN!==0;var aG=aR||aH;var aO=aM;var aC=aK;var aU;var aS;var aF;if(aH){aU=aM/2;aS=aK/2}if(aR){aF=ax({width:aM,height:aK,degree:aN});aO=aF.width;aC=aF.height;aU=aF.width/2;aS=aF.height/2}aE.width=aO;aE.height=aC;if(aG){aJ=-aM/2;aI=-aK/2;aD.save();aD.translate(aU,aS)}if(aR){aD.rotate(aN*Math.PI/180)}if(aH){aD.scale(aQ,aP)}aD.drawImage(aL,R(aJ),R(aI),R(aM),R(aK));if(aG){aD.restore()}return aE}function ae(aF){var aE=aF.length;var aD=0;var aC=0;if(aE){ak.each(aF,function(aG,aH){aD+=aH.pageX;aC+=aH.pageY});aD/=aE;aC/=aE}return{pageX:aD,pageY:aC}}function P(aF,aG,aD){var aE="";var aC;for(aC=aG,aD+=aG;aC<aD;aC++){aE+=c(aF.getUint8(aC))}return aE}function F(aJ){var aM=new l(aJ);var aF=aM.byteLength;var aE;var aN;var aL;var aC;var aD;var aK;var aI;var aO;var aG;var aH;if(aM.getUint8(0)===255&&aM.getUint8(1)===216){aG=2;while(aG<aF){if(aM.getUint8(aG)===255&&aM.getUint8(aG+1)===225){aI=aG;break}aG++}}if(aI){aN=aI+4;aL=aI+10;if(P(aM,aN,4)==="Exif"){aK=aM.getUint16(aL);aD=aK===18761;if(aD||aK===19789){if(aM.getUint16(aL+2,aD)===42){aC=aM.getUint32(aL+4,aD);if(aC>=8){aO=aL+aC}}}}}if(aO){aF=aM.getUint16(aO,aD);for(aH=0;aH<aF;aH++){aG=aO+aH*12+2;if(aM.getUint16(aG,aD)===274){aG+=8;aE=aM.getUint16(aG,aD);aM.setUint16(aG,1,aD);break}}}return aE}function ar(aH){var aC=aH.replace(N,"");var aI=atob(aC);var aF=aI.length;var aE=new am(aF);var aG=new E(aE);var aD;for(aD=0;aD<aF;aD++){aG[aD]=aI.charCodeAt(aD)}return aE}function ao(aE){var aG=new E(aE);var aF=aG.length;var aC="";var aD;for(aD=0;aD<aF;aD++){aC+=c(aG[aD])}return"data:image/jpeg;base64,"+I(aC)}function u(aD,aC){this.$element=ak(aD);this.options=ak.extend({},u.DEFAULTS,ak.isPlainObject(aC)&&aC);this.isLoaded=false;this.isBuilt=false;this.isCompleted=false;this.isRotated=false;this.isCropped=false;this.isDisabled=false;this.isReplaced=false;this.isLimited=false;this.wheeling=false;this.isImg=false;this.originalUrl="";this.canvas=null;this.cropBox=null;this.init()}u.prototype={constructor:u,init:function(){var aD=this.$element;var aC;if(aD.is("img")){this.isImg=true;this.originalUrl=aC=aD.attr("src");if(!aC){return}aC=aD.prop("src")}else{if(aD.is("canvas")&&p){aC=aD[0].toDataURL()}}this.load(aC)},trigger:function(aC,aD){var aE=ak.Event(aC,aD);this.$element.trigger(aE);return aE},load:function(aD){var aC=this.options;var aF=this.$element;var aE;var aG;if(!aD){return}aF.one(d,aC.build);if(this.trigger(d).isDefaultPrevented()){return}this.url=aD;this.image={};if(!aC.checkOrientation||!am){return this.clone()}aE=ak.proxy(this.read,this);if(h.test(aD)){return S.test(aD)?aE(ar(aD)):this.clone()}aG=new XMLHttpRequest();aG.onerror=aG.onabort=ak.proxy(function(){this.clone()},this);aG.onload=function(){aE(this.response)};aG.open("get",aD);aG.responseType="arraybuffer";aG.send()},read:function(aH){var aG=this.options;var aD=F(aH);var aI=this.image;var aF;var aE;var aC;if(aD>1){this.url=ao(aH);switch(aD){case 2:aE=-1;break;case 3:aF=-180;break;case 4:aC=-1;break;case 5:aF=90;aC=-1;break;case 6:aF=90;break;case 7:aF=90;aE=-1;break;case 8:aF=-90;break}}if(aG.rotatable){aI.rotate=aF}if(aG.scalable){aI.scaleX=aE;aI.scaleY=aC}this.clone()},clone:function(){var aE=this.options;var aH=this.$element;var aD=this.url;var aC="";var aF;var aG;if(aE.checkCrossOrigin&&U(aD)){aC=aH.prop("crossOrigin");if(aC){aF=aD}else{aC="anonymous";aF=z(aD)}}this.crossOrigin=aC;this.crossOriginUrl=aF;this.$clone=aG=ak("<img"+aB(aC)+' src="'+(aF||aD)+'">');if(this.isImg){if(aH[0].complete){this.start()}else{aH.one(an,ak.proxy(this.start,this))}}else{aG.one(an,ak.proxy(this.start,this)).one(X,ak.proxy(this.stop,this)).addClass(ah).insertAfter(aH)}},start:function(){var aC=this.$element;var aD=this.$clone;if(!this.isImg){aD.off(X,this.stop);aC=aD}m(aC[0],ak.proxy(function(aE,aF){ak.extend(this.image,{naturalWidth:aE,naturalHeight:aF,aspectRatio:aE/aF});this.isLoaded=true;this.build()},this))},stop:function(){this.$clone.remove();this.$clone=null},build:function(){var aF=this.options;var aH=this.$element;var aG=this.$clone;var aD;var aC;var aE;if(!this.isLoaded){return}if(this.isBuilt){this.unbuild()}this.$container=aH.parent();this.$cropper=aD=ak(u.TEMPLATE);this.$canvas=aD.find(".cropper-canvas").append(aG);this.$dragBox=aD.find(".cropper-drag-box");this.$cropBox=aC=aD.find(".cropper-crop-box");this.$viewBox=aD.find(".cropper-view-box");this.$face=aE=aC.find(".cropper-face");aH.addClass(V).after(aD);if(!this.isImg){aG.removeClass(ah)}this.initPreview();this.bind();aF.aspectRatio=k(0,aF.aspectRatio)||NaN;aF.viewMode=k(0,at(3,D(aF.viewMode)))||0;if(aF.autoCrop){this.isCropped=true;if(aF.modal){this.$dragBox.addClass(v)}}else{aC.addClass(V)}if(!aF.guides){aC.find(".cropper-dashed").addClass(V)}if(!aF.center){aC.find(".cropper-center").addClass(V)}if(aF.cropBoxMovable){aE.addClass(ai).data(g,o)}if(!aF.highlight){aE.addClass(ab)}if(aF.background){aD.addClass(C)}if(!aF.cropBoxResizable){aC.find(".cropper-line, .cropper-point").addClass(V)}this.setDragMode(aF.dragMode);this.render();this.isBuilt=true;this.setData(aF.data);aH.one(a,aF.built);setTimeout(ak.proxy(function(){this.trigger(a);this.isCompleted=true},this),0)},unbuild:function(){if(!this.isBuilt){return}this.isBuilt=false;this.isCompleted=false;this.initialImage=null;this.initialCanvas=null;this.initialCropBox=null;this.container=null;this.canvas=null;this.cropBox=null;this.unbind();this.resetPreview();this.$preview=null;this.$viewBox=null;this.$cropBox=null;this.$dragBox=null;this.$canvas=null;this.$container=null;this.$cropper.remove();this.$cropper=null},render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.isCropped){this.renderCropBox()}},initContainer:function(){var aD=this.options;var aE=this.$element;var aF=this.$container;var aC=this.$cropper;aC.addClass(V);aE.removeClass(V);aC.css((this.container={width:k(aF.width(),az(aD.minContainerWidth)||200),height:k(aF.height(),az(aD.minContainerHeight)||100)}));aE.addClass(V);aC.removeClass(V)},initCanvas:function(){var aG=this.options.viewMode;var aD=this.container;var aL=aD.width;var aP=aD.height;var aH=this.image;var aN=aH.naturalWidth;var aK=aH.naturalHeight;var aC=L(aH.rotate)===90;var aJ=aC?aK:aN;var aM=aC?aN:aK;var aO=aJ/aM;var aF=aL;var aI=aP;var aE;if(aP*aO>aL){if(aG===3){aF=aP*aO}else{aI=aL/aO}}else{if(aG===3){aI=aL/aO}else{aF=aP*aO}}aE={naturalWidth:aJ,naturalHeight:aM,aspectRatio:aO,width:aF,height:aI};aE.oldLeft=aE.left=(aL-aF)/2;aE.oldTop=aE.top=(aP-aI)/2;this.canvas=aE;this.isLimited=(aG===1||aG===2);this.limitCanvas(true,true);this.initialImage=ak.extend({},aH);this.initialCanvas=ak.extend({},aE)},limitCanvas:function(aL,aI){var aQ=this.options;var aG=aQ.viewMode;var aC=this.container;var aM=aC.width;var aP=aC.height;var aF=this.canvas;var aN=aF.aspectRatio;var aH=this.cropBox;var aE=this.isCropped&&aH;var aO;var aJ;var aD;var aK;if(aL){aO=az(aQ.minCanvasWidth)||0;aJ=az(aQ.minCanvasHeight)||0;if(aG){if(aG>1){aO=k(aO,aM);aJ=k(aJ,aP);if(aG===3){if(aJ*aN>aO){aO=aJ*aN}else{aJ=aO/aN}}}else{if(aO){aO=k(aO,aE?aH.width:0)}else{if(aJ){aJ=k(aJ,aE?aH.height:0)}else{if(aE){aO=aH.width;aJ=aH.height;if(aJ*aN>aO){aO=aJ*aN}else{aJ=aO/aN}}}}}}if(aO&&aJ){if(aJ*aN>aO){aJ=aO/aN}else{aO=aJ*aN}}else{if(aO){aJ=aO/aN}else{if(aJ){aO=aJ*aN}}}aF.minWidth=aO;aF.minHeight=aJ;aF.maxWidth=Infinity;aF.maxHeight=Infinity}if(aI){if(aG){aD=aM-aF.width;aK=aP-aF.height;aF.minLeft=at(0,aD);aF.minTop=at(0,aK);aF.maxLeft=k(0,aD);aF.maxTop=k(0,aK);if(aE&&this.isLimited){aF.minLeft=at(aH.left,aH.left+aH.width-aF.width);aF.minTop=at(aH.top,aH.top+aH.height-aF.height);aF.maxLeft=aH.left;aF.maxTop=aH.top;if(aG===2){if(aF.width>=aM){aF.minLeft=at(0,aD);aF.maxLeft=k(0,aD)}if(aF.height>=aP){aF.minTop=at(0,aK);aF.maxTop=k(0,aK)}}}}else{aF.minLeft=-aF.width;aF.minTop=-aF.height;aF.maxLeft=aM;aF.maxTop=aP}}},renderCanvas:function(aD){var aG=this.canvas;var aJ=this.image;var aF=aJ.rotate;var aE=aJ.naturalWidth;var aI=aJ.naturalHeight;var aH;var aC;if(this.isRotated){this.isRotated=false;aC=ax({width:aJ.width,height:aJ.height,degree:aF});aH=aC.width/aC.height;if(aH!==aG.aspectRatio){aG.left-=(aC.width-aG.width)/2;aG.top-=(aC.height-aG.height)/2;aG.width=aC.width;aG.height=aC.height;aG.aspectRatio=aH;aG.naturalWidth=aE;aG.naturalHeight=aI;if(aF%180){aC=ax({width:aE,height:aI,degree:aF});aG.naturalWidth=aC.width;aG.naturalHeight=aC.height}this.limitCanvas(true,false)}}if(aG.width>aG.maxWidth||aG.width<aG.minWidth){aG.left=aG.oldLeft}if(aG.height>aG.maxHeight||aG.height<aG.minHeight){aG.top=aG.oldTop}aG.width=at(k(aG.width,aG.minWidth),aG.maxWidth);aG.height=at(k(aG.height,aG.minHeight),aG.maxHeight);this.limitCanvas(false,true);aG.oldLeft=aG.left=at(k(aG.left,aG.minLeft),aG.maxLeft);aG.oldTop=aG.top=at(k(aG.top,aG.minTop),aG.maxTop);this.$canvas.css({width:aG.width,height:aG.height,left:aG.left,top:aG.top});this.renderImage();if(this.isCropped&&this.isLimited){this.limitCropBox(true,true)}if(aD){this.output()}},renderImage:function(aC){var aD=this.canvas;var aE=this.image;var aF;if(aE.rotate){aF=ax({width:aD.width,height:aD.height,degree:aE.rotate,aspectRatio:aE.aspectRatio},true)}ak.extend(aE,aF?{width:aF.width,height:aF.height,left:(aD.width-aF.width)/2,top:(aD.height-aF.height)/2}:{width:aD.width,height:aD.height,left:0,top:0});this.$clone.css({width:aE.width,height:aE.height,marginLeft:aE.left,marginTop:aE.top,transform:ad(aE)});if(aC){this.output()}},initCropBox:function(){var aD=this.options;var aC=this.canvas;var aF=aD.aspectRatio;var aG=az(aD.autoCropArea)||0.8;var aE={width:aC.width,height:aC.height};if(aF){if(aC.height*aF>aC.width){aE.height=aE.width/aF}else{aE.width=aE.height*aF}}this.cropBox=aE;this.limitCropBox(true,true);aE.width=at(k(aE.width,aE.minWidth),aE.maxWidth);aE.height=at(k(aE.height,aE.minHeight),aE.maxHeight);aE.width=k(aE.minWidth,aE.width*aG);aE.height=k(aE.minHeight,aE.height*aG);aE.oldLeft=aE.left=aC.left+(aC.width-aE.width)/2;aE.oldTop=aE.top=aC.top+(aC.height-aE.height)/2;this.initialCropBox=ak.extend({},aE)},limitCropBox:function(aJ,aG){var aP=this.options;var aM=aP.aspectRatio;var aD=this.container;var aK=aD.width;var aO=aD.height;var aE=this.canvas;var aF=this.cropBox;var aN=this.isLimited;var aC;var aH;var aI;var aL;if(aJ){aC=az(aP.minCropBoxWidth)||0;aH=az(aP.minCropBoxHeight)||0;aC=at(aC,aK);aH=at(aH,aO);aI=at(aK,aN?aE.width:aK);aL=at(aO,aN?aE.height:aO);if(aM){if(aC&&aH){if(aH*aM>aC){aH=aC/aM}else{aC=aH*aM}}else{if(aC){aH=aC/aM}else{if(aH){aC=aH*aM}}}if(aL*aM>aI){aL=aI/aM}else{aI=aL*aM}}aF.minWidth=at(aC,aI);aF.minHeight=at(aH,aL);aF.maxWidth=aI;aF.maxHeight=aL}if(aG){if(aN){aF.minLeft=k(0,aE.left);aF.minTop=k(0,aE.top);aF.maxLeft=at(aK,aE.left+aE.width)-aF.width;aF.maxTop=at(aO,aE.top+aE.height)-aF.height}else{aF.minLeft=0;aF.minTop=0;aF.maxLeft=aK-aF.width;aF.maxTop=aO-aF.height}}},renderCropBox:function(){var aD=this.options;var aC=this.container;var aG=aC.width;var aF=aC.height;var aE=this.cropBox;if(aE.width>aE.maxWidth||aE.width<aE.minWidth){aE.left=aE.oldLeft}if(aE.height>aE.maxHeight||aE.height<aE.minHeight){aE.top=aE.oldTop}aE.width=at(k(aE.width,aE.minWidth),aE.maxWidth);aE.height=at(k(aE.height,aE.minHeight),aE.maxHeight);this.limitCropBox(false,true);aE.oldLeft=aE.left=at(k(aE.left,aE.minLeft),aE.maxLeft);aE.oldTop=aE.top=at(k(aE.top,aE.minTop),aE.maxTop);if(aD.movable&&aD.cropBoxMovable){this.$face.data(g,(aE.width===aG&&aE.height===aF)?au:o)}this.$cropBox.css({width:aE.width,height:aE.height,left:aE.left,top:aE.top});if(this.isCropped&&this.isLimited){this.limitCanvas(true,true)}if(!this.isDisabled){this.output()}},output:function(){this.preview();if(this.isCompleted){this.trigger(n,this.getData())}else{if(!this.isBuilt){this.$element.one(a,ak.proxy(function(){this.trigger(n,this.getData())},this))}}},initPreview:function(){var aC=aB(this.crossOrigin);var aD=aC?this.crossOriginUrl:this.url;this.$preview=ak(this.options.preview);this.$viewBox.html("<img"+aC+' src="'+aD+'">');this.$preview.each(function(){var aE=ak(this);aE.data(aA,{width:aE.width(),height:aE.height(),html:aE.html()});aE.html("<img"+aC+' src="'+aD+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var aD=ak(this);var aC=aD.data(aA);aD.css({width:aC.width,height:aC.height}).html(aC.html).removeData(aA)})},preview:function(){var aG=this.image;var aE=this.canvas;var aH=this.cropBox;var aC=aH.width;var aI=aH.height;var aD=aG.width;var aK=aG.height;var aF=aH.left-aE.left-aG.left;var aJ=aH.top-aE.top-aG.top;if(!this.isCropped||this.isDisabled){return}this.$viewBox.find("img").css({width:aD,height:aK,marginLeft:-aF,marginTop:-aJ,transform:ad(aG)});this.$preview.each(function(){var aQ=ak(this);var aP=aQ.data(aA);var aR=aP.width;var aO=aP.height;var aN=aR;var aL=aO;var aM=1;if(aC){aM=aR/aC;aL=aI*aM}if(aI&&aL>aO){aM=aO/aI;aN=aC*aM;aL=aO}aQ.css({width:aN,height:aL}).find("img").css({width:aD*aM,height:aK*aM,marginLeft:-aF*aM,marginTop:-aJ*aM,transform:ad(aG)})})},bind:function(){var aD=this.options;var aE=this.$element;var aC=this.$cropper;if(ak.isFunction(aD.cropstart)){aE.on(j,aD.cropstart)}if(ak.isFunction(aD.cropmove)){aE.on(ay,aD.cropmove)}if(ak.isFunction(aD.cropend)){aE.on(aj,aD.cropend)}if(ak.isFunction(aD.crop)){aE.on(n,aD.crop)}if(ak.isFunction(aD.zoom)){aE.on(av,aD.zoom)}aC.on(y,ak.proxy(this.cropStart,this));if(aD.zoomable&&aD.zoomOnWheel){aC.on(b,ak.proxy(this.wheel,this))}if(aD.toggleDragModeOnDblclick){aC.on(q,ak.proxy(this.dblclick,this))}x.on(af,(this._cropMove=s(this.cropMove,this))).on(Z,(this._cropEnd=s(this.cropEnd,this)));if(aD.responsive){K.on(Q,(this._resize=s(this.resize,this)))}},unbind:function(){var aD=this.options;var aE=this.$element;var aC=this.$cropper;if(ak.isFunction(aD.cropstart)){aE.off(j,aD.cropstart)}if(ak.isFunction(aD.cropmove)){aE.off(ay,aD.cropmove)}if(ak.isFunction(aD.cropend)){aE.off(aj,aD.cropend)}if(ak.isFunction(aD.crop)){aE.off(n,aD.crop)}if(ak.isFunction(aD.zoom)){aE.off(av,aD.zoom)}aC.off(y,this.cropStart);if(aD.zoomable&&aD.zoomOnWheel){aC.off(b,this.wheel)}if(aD.toggleDragModeOnDblclick){aC.off(q,this.dblclick)}x.off(af,this._cropMove).off(Z,this._cropEnd);if(aD.responsive){K.off(Q,this._resize)}},resize:function(){var aF=this.options.restore;var aH=this.$container;var aC=this.container;var aD;var aG;var aE;if(this.isDisabled||!aC){return}aE=aH.width()/aC.width;if(aE!==1||aH.height()!==aC.height){if(aF){aD=this.getCanvasData();aG=this.getCropBoxData()}this.render();if(aF){this.setCanvasData(ak.each(aD,function(aI,aJ){aD[aI]=aJ*aE}));this.setCropBoxData(ak.each(aG,function(aI,aJ){aG[aI]=aJ*aE}))}}},dblclick:function(){if(this.isDisabled){return}if(this.$dragBox.hasClass(T)){this.setDragMode(au)}else{this.setDragMode(aa)}},wheel:function(aD){var aE=aD.originalEvent||aD;var aC=az(this.options.wheelZoomRatio)||0.1;var aF=1;if(this.isDisabled){return}aD.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(ak.proxy(function(){this.wheeling=false},this),50);if(aE.deltaY){aF=aE.deltaY>0?1:-1}else{if(aE.wheelDelta){aF=-aE.wheelDelta/120}else{if(aE.detail){aF=aE.detail>0?1:-1}}}this.zoom(-aF*aC,aD)},cropStart:function(aF){var aE=this.options;var aC=aF.originalEvent;var aI=aC&&aC.touches;var aH=aF;var aD;var aG;if(this.isDisabled){return}if(aI){aD=aI.length;if(aD>1){if(aE.zoomable&&aE.zoomOnTouch&&aD===2){aH=aI[1];this.startX2=aH.pageX;this.startY2=aH.pageY;aG=H}else{return}}aH=aI[0]}aG=aG||ak(aH.target).data(g);if(aw.test(aG)){if(this.trigger(j,{originalEvent:aC,action:aG}).isDefaultPrevented()){return}aF.preventDefault();this.action=aG;this.cropping=false;this.startX=aH.pageX||aC&&aC.pageX;this.startY=aH.pageY||aC&&aC.pageY;if(aG===aa){this.cropping=true;this.$dragBox.addClass(v)}}},cropMove:function(aF){var aE=this.options;var aC=aF.originalEvent;var aI=aC&&aC.touches;var aH=aF;var aG=this.action;var aD;if(this.isDisabled){return}if(aI){aD=aI.length;if(aD>1){if(aE.zoomable&&aE.zoomOnTouch&&aD===2){aH=aI[1];this.endX2=aH.pageX;this.endY2=aH.pageY}else{return}}aH=aI[0]}if(aG){if(this.trigger(ay,{originalEvent:aC,action:aG}).isDefaultPrevented()){return}aF.preventDefault();this.endX=aH.pageX||aC&&aC.pageX;this.endY=aH.pageY||aC&&aC.pageY;this.change(aH.shiftKey,aG===H?aF:null)}},cropEnd:function(aD){var aC=aD.originalEvent;var aE=this.action;if(this.isDisabled){return}if(aE){aD.preventDefault();if(this.cropping){this.cropping=false;this.$dragBox.toggleClass(v,this.isCropped&&this.options.modal)}this.action="";this.trigger(aj,{originalEvent:aC,action:aE})}},change:function(aO,aU){var aF=this.options;var aD=aF.aspectRatio;var aT=this.action;var aK=this.container;var aE=this.canvas;var aC=this.cropBox;var aS=aC.width;var aN=aC.height;var aG=aC.left;var aM=aC.top;var aW=aG+aS;var aI=aM+aN;var aP=0;var aJ=0;var aV=aK.width;var aR=aK.height;var aQ=true;var aH;var aL;if(!aD&&aO){aD=aS&&aN?aS/aN:1}if(this.limited){aP=aC.minLeft;aJ=aC.minTop;aV=aP+at(aK.width,aE.width);aR=aJ+at(aK.height,aE.height)}aL={x:this.endX-this.startX,y:this.endY-this.startY};if(aD){aL.X=aL.y*aD;aL.Y=aL.x/aD}switch(aT){case o:aG+=aL.x;aM+=aL.y;break;case W:if(aL.x>=0&&(aW>=aV||aD&&(aM<=aJ||aI>=aR))){aQ=false;break}aS+=aL.x;if(aD){aN=aS/aD;aM-=aL.Y/2}if(aS<0){aT=ap;aS=0}break;case i:if(aL.y<=0&&(aM<=aJ||aD&&(aG<=aP||aW>=aV))){aQ=false;break}aN-=aL.y;aM+=aL.y;if(aD){aS=aN*aD;aG+=aL.X/2}if(aN<0){aT=e;aN=0}break;case ap:if(aL.x<=0&&(aG<=aP||aD&&(aM<=aJ||aI>=aR))){aQ=false;break}aS-=aL.x;aG+=aL.x;if(aD){aN=aS/aD;aM+=aL.Y/2}if(aS<0){aT=W;aS=0}break;case e:if(aL.y>=0&&(aI>=aR||aD&&(aG<=aP||aW>=aV))){aQ=false;break}aN+=aL.y;if(aD){aS=aN*aD;aG-=aL.X/2}if(aN<0){aT=i;aN=0}break;case w:if(aD){if(aL.y<=0&&(aM<=aJ||aW>=aV)){aQ=false;break}aN-=aL.y;aM+=aL.y;aS=aN*aD}else{if(aL.x>=0){if(aW<aV){aS+=aL.x}else{if(aL.y<=0&&aM<=aJ){aQ=false}}}else{aS+=aL.x}if(aL.y<=0){if(aM>aJ){aN-=aL.y;aM+=aL.y}}else{aN-=aL.y;aM+=aL.y}}if(aS<0&&aN<0){aT=ac;aN=0;aS=0}else{if(aS<0){aT=Y;aS=0}else{if(aN<0){aT=A;aN=0}}}break;case Y:if(aD){if(aL.y<=0&&(aM<=aJ||aG<=aP)){aQ=false;break}aN-=aL.y;aM+=aL.y;aS=aN*aD;aG+=aL.X}else{if(aL.x<=0){if(aG>aP){aS-=aL.x;aG+=aL.x}else{if(aL.y<=0&&aM<=aJ){aQ=false}}}else{aS-=aL.x;aG+=aL.x}if(aL.y<=0){if(aM>aJ){aN-=aL.y;aM+=aL.y}}else{aN-=aL.y;aM+=aL.y}}if(aS<0&&aN<0){aT=A;aN=0;aS=0}else{if(aS<0){aT=w;aS=0}else{if(aN<0){aT=ac;aN=0}}}break;case ac:if(aD){if(aL.x<=0&&(aG<=aP||aI>=aR)){aQ=false;break}aS-=aL.x;aG+=aL.x;aN=aS/aD}else{if(aL.x<=0){if(aG>aP){aS-=aL.x;aG+=aL.x}else{if(aL.y>=0&&aI>=aR){aQ=false}}}else{aS-=aL.x;aG+=aL.x}if(aL.y>=0){if(aI<aR){aN+=aL.y}}else{aN+=aL.y}}if(aS<0&&aN<0){aT=w;aN=0;aS=0}else{if(aS<0){aT=A;aS=0}else{if(aN<0){aT=Y;aN=0}}}break;case A:if(aD){if(aL.x>=0&&(aW>=aV||aI>=aR)){aQ=false;break}aS+=aL.x;aN=aS/aD}else{if(aL.x>=0){if(aW<aV){aS+=aL.x}else{if(aL.y>=0&&aI>=aR){aQ=false}}}else{aS+=aL.x}if(aL.y>=0){if(aI<aR){aN+=aL.y}}else{aN+=aL.y}}if(aS<0&&aN<0){aT=Y;aN=0;aS=0}else{if(aS<0){aT=ac;aS=0}else{if(aN<0){aT=w;aN=0}}}break;case au:this.move(aL.x,aL.y);aQ=false;break;case H:this.zoom((function(aY,a0,aX,aZ){var a2=B(aY*aY+a0*a0);var a1=B(aX*aX+aZ*aZ);return(a1-a2)/a2})(L(this.startX-this.startX2),L(this.startY-this.startY2),L(this.endX-this.endX2),L(this.endY-this.endY2)),aU);this.startX2=this.endX2;this.startY2=this.endY2;aQ=false;break;case aa:if(!aL.x||!aL.y){aQ=false;break}aH=this.$cropper.offset();aG=this.startX-aH.left;aM=this.startY-aH.top;aS=aC.minWidth;aN=aC.minHeight;if(aL.x>0){aT=aL.y>0?A:w}else{if(aL.x<0){aG-=aS;aT=aL.y>0?ac:Y}}if(aL.y<0){aM-=aN}if(!this.isCropped){this.$cropBox.removeClass(V);this.isCropped=true;if(this.limited){this.limitCropBox(true,true)}}break}if(aQ){aC.width=aS;aC.height=aN;aC.left=aG;aC.top=aM;this.action=aT;this.renderCropBox()}this.startX=this.endX;this.startY=this.endY},crop:function(){if(!this.isBuilt||this.isDisabled){return}if(!this.isCropped){this.isCropped=true;this.limitCropBox(true,true);if(this.options.modal){this.$dragBox.addClass(v)}this.$cropBox.removeClass(V)}this.setCropBoxData(this.initialCropBox)},reset:function(){if(!this.isBuilt||this.isDisabled){return}this.image=ak.extend({},this.initialImage);this.canvas=ak.extend({},this.initialCanvas);this.cropBox=ak.extend({},this.initialCropBox);this.renderCanvas();if(this.isCropped){this.renderCropBox()}},clear:function(){if(!this.isCropped||this.isDisabled){return}ak.extend(this.cropBox,{left:0,top:0,width:0,height:0});this.isCropped=false;this.renderCropBox();this.limitCanvas(true,true);this.renderCanvas();this.$dragBox.removeClass(v);this.$cropBox.addClass(V)},replace:function(aC){if(!this.isDisabled&&aC){if(this.isImg){this.isReplaced=true;this.$element.attr("src",aC)}this.options.data=null;this.load(aC)}},enable:function(){if(this.isBuilt){this.isDisabled=false;this.$cropper.removeClass(O)}},disable:function(){if(this.isBuilt){this.isDisabled=true;this.$cropper.addClass(O)}},destroy:function(){var aC=this.$element;if(this.isLoaded){if(this.isImg&&this.isReplaced){aC.attr("src",this.originalUrl)}this.unbuild();aC.removeClass(V)}else{if(this.isImg){aC.off(an,this.start)}else{if(this.$clone){this.$clone.remove()}}}aC.removeData(f)},move:function(aC,aE){var aD=this.canvas;this.moveTo(M(aC)?aC:aD.left+az(aC),M(aE)?aE:aD.top+az(aE))},moveTo:function(aC,aF){var aE=this.canvas;var aD=false;if(M(aF)){aF=aC}aC=az(aC);aF=az(aF);if(this.isBuilt&&!this.isDisabled&&this.options.movable){if(J(aC)){aE.left=aC;aD=true}if(J(aF)){aE.top=aF;aD=true}if(aD){this.renderCanvas(true)}}},zoom:function(aE,aC){var aD=this.canvas;aE=az(aE);if(aE<0){aE=1/(1-aE)}else{aE=1+aE}this.zoomTo(aD.width*aE/aD.naturalWidth,aC)},zoomTo:function(aL,aH){var aO=this.options;var aG=this.canvas;var aF=aG.width;var aN=aG.height;var aK=aG.naturalWidth;var aM=aG.naturalHeight;var aE;var aJ;var aD;var aI;var aC;aL=az(aL);if(aL>=0&&this.isBuilt&&!this.isDisabled&&aO.zoomable){aJ=aK*aL;aD=aM*aL;if(aH){aE=aH.originalEvent}if(this.trigger(av,{originalEvent:aE,oldRatio:aF/aK,ratio:aJ/aK}).isDefaultPrevented()){return}if(aE){aI=this.$cropper.offset();aC=aE.touches?ae(aE.touches):{pageX:aH.pageX||aE.pageX||0,pageY:aH.pageY||aE.pageY||0};aG.left-=(aJ-aF)*(((aC.pageX-aI.left)-aG.left)/aF);aG.top-=(aD-aN)*(((aC.pageY-aI.top)-aG.top)/aN)}else{aG.left-=(aJ-aF)/2;aG.top-=(aD-aN)/2}aG.width=aJ;aG.height=aD;this.renderCanvas(true)}},rotate:function(aC){this.rotateTo((this.image.rotate||0)+az(aC))},rotateTo:function(aC){aC=az(aC);if(J(aC)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable){this.image.rotate=aC%360;this.isRotated=true;this.renderCanvas(true)}},scale:function(aE,aD){var aF=this.image;var aC=false;if(M(aD)){aD=aE}aE=az(aE);aD=az(aD);if(this.isBuilt&&!this.isDisabled&&this.options.scalable){if(J(aE)){aF.scaleX=aE;aC=true}if(J(aD)){aF.scaleY=aD;aC=true}if(aC){this.renderImage(true)}}},scaleX:function(aD){var aC=this.image.scaleY;this.scale(aD,J(aC)?aC:1)},scaleY:function(aC){var aD=this.image.scaleX;this.scale(J(aD)?aD:1,aC)},getData:function(aE){var aD=this.options;var aI=this.image;var aC=this.canvas;var aG=this.cropBox;var aF;var aH;if(this.isBuilt&&this.isCropped){aH={x:aG.left-aC.left,y:aG.top-aC.top,width:aG.width,height:aG.height};aF=aI.width/aI.naturalWidth;ak.each(aH,function(aJ,aK){aK=aK/aF;aH[aJ]=aE?D(aK):aK})}else{aH={x:0,y:0,width:0,height:0}}if(aD.rotatable){aH.rotate=aI.rotate||0}if(aD.scalable){aH.scaleX=aI.scaleX||1;aH.scaleY=aI.scaleY||1}return aH},setData:function(aH){var aD=this.options;var aI=this.image;var aC=this.canvas;var aG={};var aF;var aJ;var aE;if(ak.isFunction(aH)){aH=aH.call(this.element)}if(this.isBuilt&&!this.isDisabled&&ak.isPlainObject(aH)){if(aD.rotatable){if(J(aH.rotate)&&aH.rotate!==aI.rotate){aI.rotate=aH.rotate;this.isRotated=aF=true}}if(aD.scalable){if(J(aH.scaleX)&&aH.scaleX!==aI.scaleX){aI.scaleX=aH.scaleX;aJ=true}if(J(aH.scaleY)&&aH.scaleY!==aI.scaleY){aI.scaleY=aH.scaleY;aJ=true}}if(aF){this.renderCanvas()}else{if(aJ){this.renderImage()}}aE=aI.width/aI.naturalWidth;if(J(aH.x)){aG.left=aH.x*aE+aC.left}if(J(aH.y)){aG.top=aH.y*aE+aC.top}if(J(aH.width)){aG.width=aH.width*aE}if(J(aH.height)){aG.height=aH.height*aE}this.setCropBoxData(aG)}},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var aC=this.canvas;var aD={};if(this.isBuilt){ak.each(["left","top","width","height","naturalWidth","naturalHeight"],function(aE,aF){aD[aF]=aC[aF]})}return aD},setCanvasData:function(aE){var aC=this.canvas;var aD=aC.aspectRatio;if(ak.isFunction(aE)){aE=aE.call(this.$element)}if(this.isBuilt&&!this.isDisabled&&ak.isPlainObject(aE)){if(J(aE.left)){aC.left=aE.left}if(J(aE.top)){aC.top=aE.top}if(J(aE.width)){aC.width=aE.width;aC.height=aE.width/aD}else{if(J(aE.height)){aC.height=aE.height;aC.width=aE.height*aD}}this.renderCanvas(true)}},getCropBoxData:function(){var aC=this.cropBox;var aD;if(this.isBuilt&&this.isCropped){aD={left:aC.left,top:aC.top,width:aC.width,height:aC.height}}return aD||{}},setCropBoxData:function(aG){var aE=this.cropBox;var aF=this.options.aspectRatio;var aD;var aC;if(ak.isFunction(aG)){aG=aG.call(this.$element)}if(this.isBuilt&&this.isCropped&&!this.isDisabled&&ak.isPlainObject(aG)){if(J(aG.left)){aE.left=aG.left}if(J(aG.top)){aE.top=aG.top}if(J(aG.width)){aD=true;aE.width=aG.width}if(J(aG.height)){aC=true;aE.height=aG.height}if(aF){if(aD){aE.height=aE.width/aF}else{if(aC){aE.width=aE.height*aF}}}this.renderCropBox()}},getCroppedCanvas:function(aN){var aD;var aH;var aF;var aJ;var aI;var aK;var aM;var aL;var aE;var aC;var aG;if(!this.isBuilt||!this.isCropped||!p){return}if(!ak.isPlainObject(aN)){aN={}}aG=this.getData();aD=aG.width;aH=aG.height;aL=aD/aH;if(ak.isPlainObject(aN)){aI=aN.width;aK=aN.height;if(aI){aK=aI/aL;aM=aI/aD}else{if(aK){aI=aK*aL;aM=aK/aH}}}aF=R(aI||aD);aJ=R(aK||aH);aE=ak("<canvas>")[0];aE.width=aF;aE.height=aJ;aC=aE.getContext("2d");if(aN.fillColor){aC.fillStyle=aN.fillColor;aC.fillRect(0,0,aF,aJ)}aC.drawImage.apply(aC,(function(){var aO=al(this.$clone[0],this.image);var aP=aO.width;var aQ=aO.height;var aU=[aO];var aT=aG.x;var aS=aG.y;var aR;var aZ;var aX;var aW;var aY;var aV;if(aT<=-aD||aT>aP){aT=aR=aX=aY=0}else{if(aT<=0){aX=-aT;aT=0;aR=aY=at(aP,aD+aT)}else{if(aT<=aP){aX=0;aR=aY=at(aD,aP-aT)}}}if(aR<=0||aS<=-aH||aS>aQ){aS=aZ=aW=aV=0}else{if(aS<=0){aW=-aS;aS=0;aZ=aV=at(aQ,aH+aS)}else{if(aS<=aQ){aW=0;aZ=aV=at(aH,aQ-aS)}}}aU.push(R(aT),R(aS),R(aR),R(aZ));if(aM){aX*=aM;aW*=aM;aY*=aM;aV*=aM}if(aY>0&&aV>0){aU.push(R(aX),R(aW),R(aY),R(aV))}return aU}).call(this));return aE},setAspectRatio:function(aD){var aC=this.options;if(!this.isDisabled&&!M(aD)){aC.aspectRatio=k(0,aD)||NaN;if(this.isBuilt){this.initCropBox();if(this.isCropped){this.renderCropBox()}}}},setDragMode:function(aF){var aC=this.options;var aE;var aD;if(this.isLoaded&&!this.isDisabled){aE=aF===aa;aD=aC.movable&&aF===au;aF=(aE||aD)?aF:t;this.$dragBox.data(g,aF).toggleClass(T,aE).toggleClass(ai,aD);if(!aC.cropBoxMovable){this.$face.data(g,aF).toggleClass(T,aE).toggleClass(ai,aD)}}}};u.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:true,restore:true,checkCrossOrigin:true,checkOrientation:true,modal:true,guides:true,center:true,highlight:true,background:true,autoCrop:true,autoCropArea:0.8,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,wheelZoomRatio:0.1,cropBoxMovable:true,cropBoxResizable:true,toggleDragModeOnDblclick:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};u.setDefaults=function(aC){ak.extend(u.DEFAULTS,aC)};u.TEMPLATE=('<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>');u.other=ak.fn.cropper;ak.fn.cropper=function(aE){var aD=G(arguments,1);var aC;this.each(function(){var aI=ak(this);var aH=aI.data(f);var aF;var aG;if(!aH){if(/destroy/.test(aE)){return}aF=ak.extend({},aI.data(),ak.isPlainObject(aE)&&aE);aI.data(f,(aH=new u(this,aF)))}if(typeof aE==="string"&&ak.isFunction(aG=aH[aE])){aC=aG.apply(aH,aD)}});return M(aC)?this:aC};ak.fn.cropper.Constructor=u;ak.fn.cropper.setDefaults=u.setDefaults;ak.fn.cropper.noConflict=function(){ak.fn.cropper=u.other;return this}});
$(document).ready(function(){$("form .cropper-block").each(function(D){var t=800/600;var t=null;var A=null;var u=Array();var f=$(this).attr("data-id");var h=$(this).attr("data-form-name");var C=$(f).attr("filename-copy");var z=new RegExp("(_"+h+")$","g");var m=$(f.replace(z,"_"+C));var x=new RegExp("(_"+h+")$","g");$(f).data("infoForPersist_field",f.replace(x,"_infoForPersist"));var w=$(f+"_fileInput");var j=$(f+"_image");var y=$(".img-preview",this);var v=$(".docs-buttons button[data-method]",this);var B=$(".containerImageNull",this);var s=$(".noImage",this);var p=$(".container-actions",this);var i=$(f).attr("cropper-accept");if(i!=undefined){w.attr("accept",i)}else{i=w.attr("accept")}var o=$(f).attr("deletable");if(o==undefined){o=false;$(".noImage",this).remove()}else{o=true}console.log("• Loading : ","file-cropper "+f+" / Accept : "+i);var c=function(){var e=$(f).data("infoForPersist");if(e==undefined){e={height:null,width:null,file:{type:null,name:null,size:null,},dataType:"cropper",fileStatus:"empty",}}return e};var l=function(E){data=c();if(E!=undefined){data.height=E.height;data.width=E.width;data.dataType="cropper";$(f).data("infoForPersist",data)}};var n=function(e){if(e==undefined){var e=A}else{var e=e}data=c();data.file={type:e.type,name:e.name,size:e.size,};data.fileStatus="filled";$(f).data("infoForPersist",data)};var k=function(e){var e=e;e.css({display:"block",width:"100%",minWidth:0,minHeight:0,maxWidth:"none",maxHeight:"none",}).addClass("img-responsive");y.css({width:"100%",overflow:"hidden",}).addClass("img-rounded").html(e)};var d=function(){var e=j.attr("src");if(e=="#"||e==""){B.addClass("hidden");return true}else{B.removeClass("hidden");return false}};d();var g=function(e){if(e!=undefined){var e=e}else{if(A!=null){var e=A.name}}if(m.length&&e!=undefined){m.val(e)}};s.on("click",function(E){E.preventDefault();j.attr("src","#");d()});cropperOptions={aspectRatio:t,preview:f+"_block .img-preview",autoCropArea:1,responsive:true,restore:true,movable:false,zoomOnTouch:false,zoomOnWheel:false,wheelZoomRatio:false,toggleDragModeOnDblclick:false,build:function(E){k($(this).clone());l(E)},crop:function(F){var G=$(this).cropper("getImageData");var E=F.width/F.height;y.each(function(){var I=$(this);var H=I.width();var e=H/E;var J=F.width/H;I.height(e).find("img").css({width:G.naturalWidth/J,height:G.naturalHeight/J,marginLeft:-F.x/J,marginTop:-F.y/J})});l(F)},done:function(e){},};j.cropper(cropperOptions);var q=window.URL||window.webkitURL;var r;if(q){w.change(function(){var E=this.files;var e;if(!j.data("cropper")){return}if(E&&E.length){e=E[0];if(/^image\/\w+$/.test(e.type)){r=q.createObjectURL(e);j.one("built.cropper",function(){q.revokeObjectURL(r)}).cropper("replace",r);A=e;n(A);g();w.val("")}else{alert("Vous devez sélectionner un fichier de type image")}d()}})}else{w.prop("disabled",true).parent().addClass("disabled")}v.on("click",function(){var I=$(this);var G=I.data();var F;var E;if(I.prop("disabled")||I.hasClass("disabled")){return}if(j.data("cropper")&&G.method){G=$.extend({},G);if(typeof G.target!=="undefined"){F=$(G.target);if(typeof G.option==="undefined"){try{G.option=JSON.parse(F.val())}catch(H){console.log(H.message)}}}E=j.cropper(G.method,G.option,G.secondOption);switch(G.method){case"scaleX":case"scaleY":$(this).data("option",-G.option);break}if($.isPlainObject(E)&&F){try{F.val(JSON.stringify(E))}catch(H){console.log(H.message)}}}})});var a=function(f){var e=$(f+"_image");var d=$(f+"_sizeRef").attr("data-option");if(d!=undefined){d=JSON.parse(d)}else{d=null}if(e.attr("src")!="#"){var c=e.cropper("getCroppedCanvas",d);$(f).val(c.toDataURL());$($(f).data("infoForPersist_field")).val(JSON.stringify($(f).data("infoForPersist")))}else{$(f).val("")}};var b=false;$(document.body).on("submit","form",function(d){var c=$(".cropper-block",this);if(c.length){if(b==false){d.preventDefault();b=true;c.each(function(f){a($(this).attr("data-id"))});$(this).submit()}}})});